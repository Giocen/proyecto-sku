<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formulario de Salida de SKU</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      background-color: #f3f4f6;
    }
    .menu {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background-color: #fff;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
      transition: left 0.3s ease;
      z-index: 1000;
      padding: 1rem;
    }
    .menu.open {
      left: 0;
    }
    .menu ul {
      list-style-type: none;
      padding: 0;
    }
    .menu li {
      margin: 1rem 0;
    }
    .menu a {
      text-decoration: none;
      font-weight: bold;
      color: #e6007e;
    }
  </style>
</head>
<body>
  <!-- Men√∫ lateral -->
  <div id="menu" class="menu">
    <ul>
      <li><a href="#" onclick="regresarAlMenu()">üè† Inicio</a></li>
      <li><a href="#">üì¶ Entrada</a></li>
      <li><a href="#">üöö Salida</a></li>
      <li><a href="#">üîç Consulta</a></li>
    </ul>
  </div>

  <div class="min-h-screen flex items-center justify-center">
    <div class="max-w-md mx-auto bg-white shadow-xl rounded-2xl p-6 space-y-4 border border-pink-300 mt-20">
      <!-- Bot√≥n de men√∫ dentro del formulario -->
      <div class="flex justify-end">
        <button onclick="toggleMenu()" class="text-2xl text-pink-800 font-bold focus:outline-none">‚ò∞</button>
      </div>

      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Liverpool_logo.svg/2560px-Liverpool_logo.svg.png" alt="Liverpool Logo" class="w-32 mx-auto mb-2" />
      <h2 class="text-xl font-bold text-center text-pink-700 mb-4">Formulario de Salida de SKU</h2>

      <form id="salidaForm" class="space-y-4">
        <div>
          <label for="sku" class="block text-sm font-medium text-gray-700">SKU</label>
          <input type="text" id="sku" name="sku" class="mt-1 p-2 w-full border rounded-md focus:ring-2 focus:ring-pink-500" required autofocus />
        </div>
        <div>
          <label for="ubicacion" class="block text-sm font-medium text-gray-700">Ubicaci√≥n</label>
          <input type="text" id="ubicacion" name="ubicacion" class="mt-1 p-2 w-full border rounded-md focus:ring-2 focus:ring-pink-500" required />
        </div>
        <div>
          <label for="cantidad" class="block text-sm font-medium text-gray-700">Cantidad</label>
          <input type="number" id="cantidad" name="cantidad" min="1" class="mt-1 p-2 w-full border rounded-md focus:ring-2 focus:ring-pink-500" required />
        </div>
        <button type="submit" class="w-full bg-pink-600 text-white p-2 rounded-md hover:bg-pink-700 transition-all">Registrar salida</button>
      </form>

      <p id="mensaje" class="text-center text-sm mt-4 text-green-600"></p>
    </div>
  </div>

  <script>
    window.onload = function () {
      document.getElementById("sku").focus();
    };

    document.getElementById("salidaForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const sku = document.getElementById("sku").value.trim();
      const ubicacion = document.getElementById("ubicacion").value.trim();
      const cantidad = document.getElementById("cantidad").value.trim();

      if (!/^\d+$/.test(sku)) {
        mostrarMensaje("El SKU debe contener solo n√∫meros", "error");
        return;
      }

      if (!ubicacion.match(/^[a-zA-Z0-9]+$/)) {
        mostrarMensaje("La ubicaci√≥n debe ser alfanum√©rica", "error");
        return;
      }

      if (isNaN(cantidad) || parseInt(cantidad) <= 0) {
        mostrarMensaje("La cantidad debe ser un n√∫mero positivo", "error");
        return;
      }

      google.script.run
        .withSuccessHandler(function () {
          mostrarMensaje("Salida registrada exitosamente", "success");
          document.getElementById("salidaForm").reset();
          document.getElementById("sku").focus();
        })
        .withFailureHandler(function () {
          mostrarMensaje("Error al registrar salida", "error");
        })
        .registrarSalida(sku, ubicacion, cantidad);
    });

    function mostrarMensaje(mensaje, tipo) {
      Swal.fire({
        icon: tipo,
        title: tipo === "success" ? "¬°√âxito!" : "¬°Error!",
        text: mensaje,
        timer: 2000,
        showConfirmButton: false,
      });
    }

    function toggleMenu() {
      document.getElementById("menu").classList.toggle("open");
    }

    function regresarAlMenu() {
      document.getElementById("menu").classList.remove("open");
    }
  </script>
</body>
</html>